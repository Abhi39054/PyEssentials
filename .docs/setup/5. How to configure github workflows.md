# ğŸ“˜ GitHub Workflow Configuration Guide

This guide explains how to configure GitHub Actions workflows for your project, set up required secret keys, and configure approval rules for protected environments such as **pypi-prod**.

---

## ğŸ“‚ Where to Store Workflow Files

GitHub Actions workflows must be stored inside:

```
.github/workflows/
```

Any `.yml` or `.yaml` file placed here is automatically detected and executed by GitHub Actions.

---

## ğŸ”‘ Using Secrets in Workflows

Workflows may need sensitive data such as API tokens or credentials.  
These **must not be hard-coded** â€” always store them in GitHub Secrets.

Example usage inside a workflow:

```yaml
password: ${{ secrets.TESTPYPI_API_TOKEN }}
```

---

## ğŸ” How to Set Up Secret Keys

### 1. Open Your Repository  
Navigate to your GitHub repository.

### 2. Open Settings  
Click **Settings** â†’ **Security** â†’ **Secrets and variables** â†’ **Actions**

### 3. Add the Necessary Secrets  
Click **New repository secret** and add:

| Secret Name            | Value to Store             | Purpose |
|------------------------|-----------------------------|---------|
| `TESTPYPI_API_TOKEN`   | Your TestPyPI token         | Token for publishing to TestPyPI |
| `TESTPYPI_USERNAME`    | `__token__` *(optional)*    | Username for token-based auth |
| `PYPI_API_TOKEN`       | Your PyPI token             | Token for publishing to PyPI |

> Note: When authenticating using API tokens, the username is always `__token__`.

---

## ğŸ›¡ï¸ Setting Up Approvals for `pypi-prod` Environment

For safety, PyPI publishing should require **manual approval**.

### âœ”ï¸ Step 1 â€” Create the Environment
Go to:
```
Repository â†’ Settings â†’ Environments â†’ New environment
```

Name it:

```
pypi-prod
```

### âœ”ï¸ Step 2 â€” Add Required Reviewers
Inside the environment:

- Enable **Required Reviewers**
- Add GitHub usernames of people allowed to approve deployments  
  Example:
  - `Abhi39054`

### âœ”ï¸ Step 3 â€” Workflow Configuration Example

Add this to your PyPI publish job:

```yaml
environment:
  name: pypi-prod
```

GitHub will now:

- Pause the job  
- Ask the required reviewers for approval  
- Only continue after approval is granted

---

## Workflow Triggers and Permissions

This section clarifies who can run workflows and under what conditions.

### Who can trigger a workflow?

Workflows can be triggered by various events. Here's a summary for this project:

| Action            | PR | Regular push | Keyword push | Manual dispatch |
|------------------|----|--------------|---------------|------------------|
| **Tests**         | âœ… | âœ…           | âœ…            | âœ…               |
| **Build**         | âœ… | âœ…           | âœ…            | âœ…               |
| **TestPyPI publish** | âŒ | âŒ        | âœ…            | âŒ               |
| **PyPI publish**  | âŒ | âŒ           | Approval required | âŒ          |



Below keywords are accpeted:
    
    1. pypi release
    
    2. pypi publish

only the commit having these keywords will run the testpypi and pypi Action of the workflows.

### Who can manually run (`workflow_dispatch`) a workflow?

GitHub restricts manual workflow runs to users with specific permissions:

| Role                | Can Manually Run Workflow? |
|---------------------|:--------------------------:|
| **Owner / Admin**   |             âœ…             |
| **Write access**    |             âœ…             |
| **Triage / Read**   |             âŒ             |
| **External User**   |             âŒ             |

---

## ğŸ“ Summary

- Store workflows in `.github/workflows/`
- Use GitHub Secrets for authentication
- Use `pypi-prod` (or similar) for protected publishing
- Add required reviewers for safety
- Workflow waits until approved before publishing to PyPI
